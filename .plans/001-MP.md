# Personal Website - Master Plan

**Date:** 2024-11-26
**Estimated Total Story Points:** 19

---

## Executive Summary

### What We're Building
A minimal personal website with two main sections: an About page (professional info, education, social links) and a Blog (markdown posts with LaTeX and code highlighting). The site will be statically generated with Astro, styled with Tailwind CSS, and deployed to GitHub Pages.

### Why It Matters
Provides a professional online presence with a low-friction workflow for publishing technical blog posts (~1/month).

### Scope
**In:** About page, blog listing, individual blog posts, dark mode, LaTeX rendering, code highlighting, GitHub Pages deployment
**Out:** Comments, analytics, CMS, RSS feed, sitemap, search functionality (all can be added later)

### Technology Choices
| Technology | Choice | Rationale |
|------------|--------|-----------|
| Framework | Astro 5.x | Built-in markdown, content collections, static output |
| Styling | Tailwind CSS | Fast iteration, `@astrojs/tailwind` is zero-config |
| Content | Astro Content Collections | Type-safe frontmatter, validation, better DX |
| Code Highlighting | Shiki (built-in) | No config needed, dual-theme support |
| LaTeX | `remark-math` + `rehype-katex` | Server-rendered, no client JS |
| Dark Mode | CSS variables + Tailwind `selector` mode | Single source of truth, no flash |
| Icons | Inline SVG | No dependencies |
| Deployment | GitHub Actions | Official `withastro/action`, auto-deploy on push |

### Key Architectural Decisions
1. **Content Collections over `Astro.glob()`** - Type-safe frontmatter prevents broken posts
2. **CSS variables for theming** - Easy to maintain, works with Tailwind dark: prefix
3. **Inline head script for dark mode** - Prevents flash of wrong theme
4. **Conditional KaTeX CSS loading** - Only load on blog posts, not about page
5. **Date-prefixed filenames** - `YYYY-MM-DD-slug.md` for natural sorting

---

## System Architecture

### Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                        Build Time (Astro)                        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐ │
│  │  src/content/   │───▶│ Content         │───▶│ Static HTML │ │
│  │  blog/*.md      │    │ Collections     │    │ + CSS + JS  │ │
│  └─────────────────┘    └─────────────────┘    └─────────────┘ │
│           │                      │                     │        │
│           ▼                      ▼                     ▼        │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐ │
│  │ Frontmatter     │    │ remark-math     │    │ Shiki       │ │
│  │ Schema (Zod)    │    │ rehype-katex    │    │ Highlighting│ │
│  └─────────────────┘    └─────────────────┘    └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                              │
                              │ git push
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     GitHub Actions                               │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐ │
│  │ Checkout        │───▶│ withastro/      │───▶│ Deploy to   │ │
│  │                 │    │ action (build)  │    │ gh-pages    │ │
│  └─────────────────┘    └─────────────────┘    └─────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     GitHub Pages (CDN)                           │
│                                                                  │
│  username.github.io ──▶ Static HTML served globally             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Project Structure

```
website/
├── .github/
│   └── workflows/
│       └── deploy.yml              # GitHub Actions auto-deploy
├── public/
│   └── favicon.svg
├── src/
│   ├── components/
│   │   ├── BaseHead.astro          # Meta tags, conditional KaTeX CSS
│   │   ├── Header.astro            # Navigation + dark mode toggle
│   │   ├── Footer.astro            # Copyright
│   │   └── SocialLinks.astro       # LinkedIn, GitHub icons
│   ├── content/
│   │   └── blog/                   # Blog posts (markdown)
│   │       ├── _template.md        # Template for new posts (excluded)
│   │       └── 2024-01-15-example.md
│   ├── content.config.ts           # Content collection schema
│   ├── layouts/
│   │   ├── BaseLayout.astro        # HTML shell, dark mode script
│   │   └── BlogPostLayout.astro    # Post-specific layout
│   ├── pages/
│   │   ├── index.astro             # About page (home)
│   │   └── blog/
│   │       ├── index.astro         # Blog listing
│   │       └── [...slug].astro     # Dynamic post routes
│   └── styles/
│       └── global.css              # Tailwind + CSS variables
├── astro.config.mjs
├── tailwind.config.mjs
├── package.json
└── tsconfig.json
```

---

## Implementation Tickets

### Ticket #1: Project Initialization & Configuration

**Story Points:** 3

**Description:**
Initialize the Astro project with Tailwind CSS and configure all necessary tooling for the site.

**Tasks:**
- Run `npm create astro@latest` with minimal template
- Initialize git repository: `git init`
- Add Tailwind integration: `npx astro add tailwind`
- Install KaTeX dependencies: `npm install remark-math rehype-katex`
- Configure `astro.config.mjs`:
  - Set `site` URL for GitHub Pages
  - Add Tailwind integration
  - Configure markdown with remark-math, rehype-katex
  - Configure Shiki with dual themes (github-light/github-dark)
- Configure `tailwind.config.mjs`:
  - Set `darkMode: 'selector'`
  - Define blue accent color palette
- Create `src/styles/global.css`:
  - Tailwind directives
  - CSS variables for light/dark themes
- Add `.gitignore` for node_modules, dist, .astro

**Acceptance Criteria:**
- [ ] `npm run dev` starts development server
- [ ] Tailwind classes work in components
- [ ] TypeScript configured with strict mode
- [ ] Dark mode CSS variables defined

**Dependencies:** None

**Files:**
- `astro.config.mjs` (new)
- `tailwind.config.mjs` (new)
- `src/styles/global.css` (new)
- `package.json` (new)
- `tsconfig.json` (new)
- `.gitignore` (new)

---

### Ticket #2: Content Collection Schema

**Story Points:** 2

**Description:**
Set up Astro Content Collections with type-safe frontmatter schema for blog posts.

**Tasks:**
- Create `src/content.config.ts` with blog collection:
  - `title` (string, required)
  - `description` (string, required, max 160 chars)
  - `pubDate` (date, required)
  - `updatedDate` (date, optional)
  - `draft` (boolean, default false)
- Create `src/content/blog/` directory
- Create `src/content/blog/_template.md` as reference (excluded from build)
- Create sample post `2024-01-15-hello-world.md` with test content including:
  - Markdown formatting
  - Code block
  - LaTeX equation

**Acceptance Criteria:**
- [ ] TypeScript types generated for blog collection
- [ ] Sample post passes schema validation
- [ ] `_template.md` excluded from collection
- [ ] `getCollection('blog')` returns typed posts

**Dependencies:** Ticket #1

**Files:**
- `src/content.config.ts` (new)
- `src/content/blog/_template.md` (new)
- `src/content/blog/2024-01-15-hello-world.md` (new)

---

### Ticket #3: Base Layout & Head Component

**Story Points:** 3

**Description:**
Create the foundational layout components that wrap all pages, including SEO meta tags and dark mode initialization. Includes stub Header/Footer so BaseLayout compiles (full implementation in Tickets #4-5).

**Tasks:**
- Create `src/components/BaseHead.astro`:
  - Charset, viewport meta tags
  - Dynamic title and description props
  - OpenGraph tags (og:title, og:description, og:type)
  - Canonical URL
  - Conditional KaTeX CSS (only when `needsMath` prop is true)
  - Favicon link
- Create stub `src/components/Header.astro`:
  - Minimal placeholder (e.g., `<header><nav>Site Name</nav></header>`)
  - Will be fully implemented in Ticket #4
- Create stub `src/components/Footer.astro`:
  - Minimal placeholder (e.g., `<footer>© 2024</footer>`)
  - Will be fully implemented in Ticket #5
- Create `src/layouts/BaseLayout.astro`:
  - HTML shell with `lang="en"`
  - BaseHead component
  - Import and render Header component
  - Main content area with `<slot />`
  - Import and render Footer component
  - Inline script for dark mode (before body renders):
    ```javascript
    if (localStorage.theme === 'dark' ||
        (!localStorage.theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    }
    ```
  - Import global styles
- Style body with CSS variables for bg/text colors

**Acceptance Criteria:**
- [ ] All pages render with proper HTML structure
- [ ] Meta tags appear correctly in page source
- [ ] No dark mode flash on page load
- [ ] KaTeX CSS only loads on blog posts
- [ ] BaseLayout includes Header and Footer (stubs for now)

**Dependencies:** Ticket #1

**Files:**
- `src/components/BaseHead.astro` (new)
- `src/components/Header.astro` (new - stub)
- `src/components/Footer.astro` (new - stub)
- `src/layouts/BaseLayout.astro` (new)

---

### Ticket #4: Header & Dark Mode Toggle

**Story Points:** 2

**Description:**
Implement the full site header with navigation and functional dark mode toggle (replacing stub from Ticket #3).

**Tasks:**
- Implement `src/components/Header.astro`:
  - Site title/name (links to home)
  - Navigation links: About, Blog
  - Dark mode toggle button with sun/moon SVG icons
  - Responsive layout (works on mobile)
- Implement toggle functionality:
  - Click toggles `dark` class on `<html>`
  - Persist preference to localStorage
  - Update icon based on current theme
- Style with Tailwind:
  - Sticky/fixed header (optional)
  - Clean minimal design
  - Smooth transition on theme change

**Acceptance Criteria:**
- [ ] Navigation links work
- [ ] Dark mode toggle switches themes
- [ ] Theme persists across page refreshes
- [ ] Icon changes based on current theme
- [ ] Works on mobile viewport

**Dependencies:** Ticket #3

**Files:**
- `src/components/Header.astro` (modify - replace stub)

---

### Ticket #5: Footer & Social Links

**Story Points:** 2

**Description:**
Implement the full footer with social links (replacing stub from Ticket #3).

**Tasks:**
- Create `src/components/SocialLinks.astro`:
  - Inline SVG for LinkedIn icon
  - Inline SVG for GitHub icon
  - Props for URLs (configurable)
  - Hover effects (subtle color change)
  - Opens in new tab with `rel="noopener noreferrer"`
- Implement `src/components/Footer.astro` (replacing stub):
  - Copyright with current year
  - Social links component
  - Simple centered layout

**Acceptance Criteria:**
- [ ] Social icons render correctly
- [ ] Links open in new tab
- [ ] Hover states work in light and dark mode
- [ ] Copyright year is dynamic

**Dependencies:** Ticket #3

**Files:**
- `src/components/SocialLinks.astro` (new)
- `src/components/Footer.astro` (modify - replace stub)

---

### Ticket #6: About Page (Homepage)

**Story Points:** 2

**Description:**
Build the About page as the site's landing page with professional information.

**Tasks:**
- Create `src/pages/index.astro`:
  - Use BaseLayout
  - Single column layout, centered with max-width
  - Brief intro/bio section (placeholder text for now)
  - Professional experience section:
    - Simple list format
    - Company, role, dates (placeholder)
  - Education section:
    - School, degree, dates (placeholder)
  - Social links at bottom
- Style with Tailwind:
  - Centered content with max-width (prose-like)
  - Blue accent for headings/links
  - Clean typography
  - Adequate whitespace between sections

**Acceptance Criteria:**
- [ ] Page renders at `/`
- [ ] All sections visible and well-formatted
- [ ] Responsive on mobile
- [ ] Works in light and dark mode

**Dependencies:** Ticket #4, Ticket #5

**Files:**
- `src/pages/index.astro` (new)

---

### Ticket #7: Blog Listing Page

**Story Points:** 2

**Description:**
Create the blog index page showing all posts in "Date - Title" format, newest first.

**Tasks:**
- Create `src/pages/blog/index.astro`:
  - Use BaseLayout
  - Fetch posts with `getCollection('blog')`
  - Filter out drafts in production: `import.meta.env.PROD ? !data.draft : true`
  - Sort by `pubDate` descending
  - Render as list:
    - Format: "Jan 15, 2024 - Post Title"
    - Each title links to `/blog/[slug]`
  - Simple heading "Blog" at top
- Date formatting with `Intl.DateTimeFormat` (no library needed)

**Acceptance Criteria:**
- [ ] Page renders at `/blog`
- [ ] Posts sorted newest first
- [ ] Drafts hidden in production, shown in dev
- [ ] Date format is readable (e.g., "Jan 15, 2024")
- [ ] Links navigate to correct post

**Dependencies:** Ticket #2, Ticket #3

**Files:**
- `src/pages/blog/index.astro` (new)

---

### Ticket #8: Individual Blog Post Pages

**Story Points:** 3

**Description:**
Create dynamic routes for individual blog posts with full markdown rendering, code highlighting, and LaTeX support.

**Tasks:**
- Create `src/layouts/BlogPostLayout.astro`:
  - Extends BaseLayout with `needsMath={true}` for KaTeX CSS
  - Display post title as h1
  - Display formatted date
  - Prose styling for content (Tailwind typography or custom)
  - Slot for rendered markdown
- Create `src/pages/blog/[...slug].astro`:
  - `getStaticPaths()` to generate routes from collection
  - Render post with BlogPostLayout
  - Pass frontmatter data to layout
- Verify rendering:
  - Markdown headings, lists, links
  - Code blocks with syntax highlighting (both themes)
  - LaTeX equations (inline and block)

**Acceptance Criteria:**
- [ ] Posts render at `/blog/[slug]`
- [ ] Title and date display correctly
- [ ] Markdown renders properly
- [ ] Code highlighting works in both themes
- [ ] LaTeX equations render correctly
- [ ] Responsive on mobile

**Dependencies:** Ticket #2, Ticket #3

**Files:**
- `src/layouts/BlogPostLayout.astro` (new)
- `src/pages/blog/[...slug].astro` (new)

---

### Ticket #9: GitHub Actions Deployment

**Story Points:** 2

**Description:**
Set up automated deployment to GitHub Pages via GitHub Actions.

**Tasks:**
- Create `.github/workflows/deploy.yml`:
  - Trigger on push to `main` branch
  - Use `withastro/action@v3` for build
  - Deploy using `actions/deploy-pages@v4`
  - Set proper permissions (contents: read, pages: write, id-token: write)
- Update `astro.config.mjs` with correct `site` URL
- Create README.md with:
  - Local development instructions
  - How to add a new blog post
  - Deployment info
- Test deployment workflow

**Acceptance Criteria:**
- [ ] Push to main triggers build
- [ ] Site deploys successfully to GitHub Pages
- [ ] Site accessible at username.github.io
- [ ] README documents the workflow

**Dependencies:** Ticket #1

**Files:**
- `.github/workflows/deploy.yml` (new)
- `README.md` (new)

---

### Ticket #10: Polish & Responsiveness

**Story Points:** 2

**Description:**
Final styling pass for visual polish, responsiveness, and production readiness.

**Tasks:**
- Test all pages at mobile viewport (375px)
- Add smooth transitions for dark mode toggle
- Ensure code blocks scroll horizontally on mobile
- Verify LaTeX renders correctly in both themes
- Add favicon to `public/`
- Performance check with Lighthouse
- Fix any accessibility issues (color contrast, focus states)

**Acceptance Criteria:**
- [ ] All pages responsive on mobile
- [ ] Lighthouse scores > 90 in all categories:
  - [ ] Performance > 90
  - [ ] Accessibility > 90
  - [ ] Best Practices > 90
  - [ ] SEO > 90
- [ ] Smooth theme transitions

**Dependencies:** Ticket #6, Ticket #7, Ticket #8, Ticket #9

**Files:**
- `public/favicon.svg` (new)
- Various style tweaks to existing files

---

## Implementation Order

```
[1] Init & Config ─────┬───▶ [2] Content Schema ───┬──▶ [7] Blog List ──┐
                       │                           │                     │
                       ├───▶ [3] Base Layout* ─────┼──▶ [8] Blog Posts ──┤
                       │         │                 │                     │
                       │         ├──▶ [4] Header   │                     │
                       │         │                 │                     │
                       │         └──▶ [5] Footer ──┼──▶ [6] About Page ──┤
                       │                           │                     │
                       └───▶ [9] Deployment ───────┴─────────────────────┴──▶ [10] Polish

* Ticket #3 creates stub Header/Footer so pages can be built in parallel with #4/#5
```

**Parallel work opportunities:**
- After Ticket #1: Tickets #2, #3, #9 can all start in parallel
- After Ticket #3: Tickets #4, #5, #7, #8 can all start (pages use stub nav initially)
- Ticket #9 (Deployment) can be done early to validate pipeline with minimal content

**Recommended execution for solo developer:**
1. Ticket #1 (Init)
2. Tickets #2, #3 in parallel
3. Tickets #4, #5, #7, #8 in parallel (or sequentially if preferred)
4. Ticket #6 (About - needs #4, #5 for full nav)
5. Ticket #9 (Deploy)
6. Ticket #10 (Polish)

**Total: 19 story points**

---

## Blog Post Workflow (End State)

Adding a new blog post:

1. Copy template: `cp src/content/blog/_template.md src/content/blog/2024-11-26-my-post.md`

2. Edit frontmatter and content:
   ```markdown
   ---
   title: "My New Post"
   description: "A brief description for SEO"
   pubDate: 2024-11-26
   ---

   Your content with **markdown**, `code`, and $\LaTeX$.
   ```

3. Preview locally: `npm run dev`

4. Publish: `git add . && git commit -m "Add post" && git push`

5. Live in ~2 minutes at `username.github.io/blog/my-post`

---

## Critical Gotchas

1. **Content directory is special**: `src/content/` must exist and contain `config.ts`
2. **`getStaticPaths` required**: Dynamic routes like `[...slug].astro` need this function
3. **Date format in frontmatter**: Use ISO format (`2024-01-15`), Zod coerces to Date
4. **KaTeX CSS required**: `rehype-katex` generates HTML but not styles - must add CSS link
5. **Dark mode flash prevention**: Use `is:inline` script in `<head>`, not external JS
6. **Shiki dual themes**: Need CSS to show correct theme based on dark mode class
7. **GitHub Pages base path**: For `username.github.io`, don't set `base` - only set `site`
